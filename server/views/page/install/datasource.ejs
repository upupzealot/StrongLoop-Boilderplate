<%- include(_v + '/commen/header') %>

<div class="row">
  <div class="well" style="max-width: 320px;margin: 0 auto;">
    <h3>设置数据源</h3>
    <hr>

    <div id="form" class="clearfix">
    <%- include(_v + '/component/form/form', {
        id: 'form', 
        fields: [{
          type: 'combobox',
          opt: {
            name: 'db',
            options: [
              'memory',
              'postgresql',
              'mysql',
              'redis',
              'mongodb',
            ],
            default: 'memory',
            linkages: {
              rootName: 'connector',
              help: {
                memory: '<i class="fa fa-exclamation-triangle" aria-hidden="true"></i>'
                      + ' 纯内存数据库,数据在重启后丢失',
              },
              form: {
                postgresql: 'form-postgresql',
                mysql: 'form-mysql',
                redis: 'form-redis',
                mongodb: 'form-mongodb',
              },
            },
            label: '数据库',
          },
        },
        '<hr>'],
      }); %>

      <div id="form-postgresql" class="clearfix" hidden="true">
      <%- include(_v + '/component/form/form', {
          id: 'form-postgresql',
          fields: [{
            type: 'input',
            opt: {
              name: 'host',
              type: 'text',
              vali: 'username("aaa")',
              label: 'host',
            },
          },
          '<hr>'],
        }); %>
      </div>

      <div id="form-mysql" class="clearfix" hidden="true">
      <%- include(_v + '/component/form/form', {
          id: 'form-mysql',
          fields: [{
            type: 'input',
            opt: {
              name: 'host',
              type: 'text',
              vali: /[\w]+/,
              label: 'host',
            },
          },
          '<hr>'],
        }); %>
      </div>

      <button id="form-submit" class="btn btn-default btn-block">提交</button>
    </div>
  </div>
</div>

<script type="text/javascript">
$(function() {
  $('#form-submit').on('click', function() {
    var form = $('#form').data('val')();

    console.log(JSON.stringify(form, null, 2))
    $.ajax({
      type: 'POST',
      data: form,
    }).success(function(msg) {
      console.log(msg);
    }).error(function(err) {
      console.log(err);
    });
  });
});
</script>

<%- include(_v + '/commen/footer') %>
